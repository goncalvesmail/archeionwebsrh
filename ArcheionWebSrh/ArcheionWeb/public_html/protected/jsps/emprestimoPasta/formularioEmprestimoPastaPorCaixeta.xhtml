<jsp:root xmlns:jsp="http://java.sun.com/JSP/Page"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:t="http://myfaces.apache.org/tomahawk" version="2.0">

	<style>
td,input {
	color: #ffffff
}
</style>

	<ui:composition template="/protected/jsps/layout/masterLayout.xhtml">

		<ui:define name="conteudo">
		<center>
			<br />
			<table width="100%" border="0" cellpadding="0" cellspacing="0"
				bgcolor="#FFFFFF">
				<tr>
					<td class="titulopag" align="left">#{msgs['emprestimo.pasta.titulo']}</td>
				</tr>
				<tr>
					<td height="1"
						background="${facesContext.externalContext.requestContextPath}/images/r_bg.gif">
					</td>
				</tr>
				<tr>
					<td height="30px">
						<h:messages globalOnly="true" errorClass="errorClass" infoClass="infoClass" warnClass="warnClass" layout="table" />
					</td>
				</tr>				
			</table>	

			<h:form id="form">
			
				<table width="100%">
 					<tr>
						<td colspan="2" >
							<rich:dataTable rows="0" id="table" rowKeyVar="index"
							value="#{emprestimoPastaBean.listaEmprestarPastaPorCaixeta}" var="lista"
							rendered="#{not empty emprestimoPastaBean.listaEmprestimoPasta}" align="center"
							cellpadding="0" cellspacing="0" styleClass="tabela tabelaCss"
							headerClass="tabela_header" rowClasses="odd, even"
							columnClasses="col,col,col,col,col,col,col,col"
							style="width: 100%; cellspacing:2;">
							<rich:column>
								<f:facet name="header">S</f:facet>
																		
								<h:selectOneRadio value="#{lista.selecionado}" onchange="atualiza#{index}();">  
									<f:selectItem itemValue="1" itemLabel="" />  
								</h:selectOneRadio>  
    
								<!-- bean.Marcar: seta numa variavel o valor da lista.get(index) -->  
								<a4j:jsFunction name="atualiza#{index}" action="#{emprestimoPastaBean.marcar}" reRender="table">  
									<f:setPropertyActionListener value="#{index}" target="#{emprestimoPastaBean.index}" />  
								</a4j:jsFunction>
							</rich:column>
							<rich:column>
								<f:facet name="header">
									<h:outputText value="#{msgs['caixa.texto.local']}" />
								</f:facet>
								<h:outputText value="#{lista.local.nome}" />
							</rich:column>
							<rich:column>
								<f:facet name="header">
									<h:outputText value="#{msgs['emprestimo.pasta.solicitada']}" />
								</f:facet>
								<h:outputText value="#{lista.titulo}" />
							</rich:column>	
							<rich:column>
								<f:facet name="header">
									<h:outputText value="#{msgs['geral.descricao']}" />
								</f:facet>
								<h:outputText value="#{lista.descricao}" />
							</rich:column>
							<rich:column>
								<f:facet name="header">
									<h:outputText value="#{msgs['pasta.numero.protocolo']}" />
								</f:facet>
								<h:outputText value="#{lista.numeroProtocolo}" />
							</rich:column>				
						</rich:dataTable></td>
					</tr>							
									
					<tr>
						<td align="right">
							<h:outputLabel styleClass="labelObrigatorio" 
								value="#{msgs['emprestimo.pasta.responsavel']}:" for="responsavel" />
						</td>
						<td  align="left">
							<h:selectOneMenu id="responsavel" styleClass="campo" 
								value="#{emprestimoPastaBean.emprestimo.responsavel.id}" >  
								<f:selectItems value="#{emprestimoPastaBean.listaResponsavel}" />  
							</h:selectOneMenu>
						</td>	
					</tr>			
					
					<tr>
						<td align="right">
							<h:outputLabel styleClass="labelObrigatorio" 
								value="#{msgs['emprestimo.pasta.data.saida']}:" for="dataSaida" />
						</td>
						<td  align="left">
							<t:inputCalendar id="dataSaida"
								renderAsPopup="true"
								popupTodayString="#{msgs['geral.texto.data']}"
								popupWeekString="SM" popupDateFormat="dd/MM/yyyy"
								renderPopupButtonAsImage="true"
								popupSelectDateMessage="#{msgs['geral.texto.data.selecione']}" 
								styleClass="campo"
								required="true"
								requiredMessage="#{msgs['error.business.requiredField']}" 
								value="#{emprestimoPastaBean.emprestimo.dataEmprestimo}"
								converterMessage="#{msgs['error.business.dataInvalida']}">
								
							</t:inputCalendar>
							<h:message for="dataSaida" errorStyle="color: red;" />
						</td>	
					</tr>	
					
					<tr>
						<td align="right">
							<h:outputLabel styleClass="labelObrigatorio" for="previsaoDevolucao"
								value="#{msgs['emprestimo.pasta.data.previsao.devolucao']}:" />
						</td>
						<td align="left">
							<t:inputCalendar id="previsaoDevolucao"
								renderAsPopup="true"
								popupTodayString="#{msgs['geral.texto.data']}"
								popupWeekString="SM" popupDateFormat="dd/MM/yyyy"
								renderPopupButtonAsImage="true"
								popupSelectDateMessage="#{msgs['geral.texto.data.selecione']}" 
								styleClass="campo"
								required="true"
								requiredMessage="#{msgs['error.business.requiredField']}" 
								value="#{emprestimoPastaBean.emprestimo.previsaoDevolucao}"
								converterMessage="#{msgs['error.business.dataInvalida']}">
								
							</t:inputCalendar>
							<h:message for="previsaoDevolucao" errorStyle="color: red;" />
						</td>	
					</tr>						
					
					<tr>
						<td colspan="2" align="center">						
							<table width="40%">
							<tr>
								<td align="center">								
									<fieldset>
									<legend><span class="label">#{msgs['emprestimo.pasta.solicitante']}</span></legend>
										
										<table width="1%">
											<tr>
												<td align="right" width="50%">
													<h:outputLabel styleClass="label" 
														value="#{msgs['emprestimo.pasta.interno']}:" for="interno" />
												</td>
												<td align="left">
													<h:selectOneMenu id="interno" styleClass="campo" 
														value="#{emprestimoPastaBean.emprestimo.solicitante.id}" >  
														<f:selectItem itemValue="-1" itemLabel=""/>
														<f:selectItems value="#{emprestimoPastaBean.listaSolicitante}" />  
													</h:selectOneMenu>
												</td>	
											</tr>	
											<tr>
												<td align="right" width="50%">
													<h:outputLabel styleClass="label" 
														value="#{msgs['emprestimo.pasta.externo']}:" for="externo" />
												</td>
												<td align="left">
													<h:inputText id="externoeLocal"	styleClass="campo"
														value="#{emprestimoPastaBean.emprestimo.solicitanteExterno}" />
												</td>	
											</tr>												
										</table>
										
									</fieldset>
								</td>
							</tr>
							</table>						
						</td>
					</tr>						


					<tr>
						<td colspan="2" align="center">
							<br/>
							<h:commandButton value="#{msgs['geral.botao.salvar']}" styleClass="botaoIntuitivo"
								action="#{emprestimoPastaBean.incluirPorCaixeta}" />							
							<h:commandButton value="#{msgs['geral.botao.cancelar']}" styleClass="botaoIntuitivo"
								action="#{emprestimoPastaBean.findAll}" immediate="true" />	
						</td>	
					</tr>		
				</table>	

			</h:form>
		</center>
		</ui:define>
	</ui:composition>
</jsp:root>